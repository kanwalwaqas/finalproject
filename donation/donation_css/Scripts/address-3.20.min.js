/*! Copyright © 2009-2014 Postcode Anywhere (Holdings) Ltd. (http://www.postcodeanywhere.co.uk)
 *
 * Address v3.20
 * Component for address lookup integrations.
 *
 * WEB-2-3 23/09/2014 16:36:47
 */
(function(n,t){function e(){r.addEventListener?(i.ignore(r,"DOMContentLoaded",e),f=!0,i.ready()):r.readyState==="complete"&&(i.ignore(r,"onreadystatechange",e),f=!0,i.ready())}function v(){r.readyState==="complete"?(f=!0,i.ready()):(r.addEventListener?i.listen(r,"DOMContentLoaded",e):i.listen(r,"onreadystatechange",e),i.listen(n,"load",e))}function h(t){var r,f,u;if(i.blockRequests&&i.waitingRequest){i.requestQueue=[t.index];return}if(t.block&&(i.blockRequests=!0),t.queue&&i.waitingRequest){i.requestQueue.push(t.index);return}if(i.waitingRequest=!0,t.cache)for(r=0;r<i.requests.length;r++)if(i.requests[r]&&i.requests[r].service===t.service&&i.requests[r].response){f=!0;for(u in t.data)if(t.data[u]!==i.requests[r].data[u]){f=!1;break}if(f){function e(){t.callback(i.requests[r].response)}n.setImmediate?n.setImmediate(e):n.setTimeout(e,1),i.requests[t.index]=null;return}}t.post?s(t):a(t)}function y(n){i.waitingRequest=!1,n.block&&(i.blockRequests=!1),n.response.Items.length===1&&n.response.Items[0].Error!==t?n.error(n.response.Items[0].Description):n.success(n.response.Items,n.response),n.cache||(i.requests[n.index]=null),i.requestQueue.length&&h(i.requests[i.requestQueue.shift()])}function a(n){navigator.appName=="Microsoft Internet Explorer"?w(n):p(n)}function p(n){var t=new XMLHttpRequest,f=i.protocol+"//"+i.host+"/"+n.service+"/"+i.endpoint,u="",r;for(r in n.data)u+=(u?"&":"?")+r+"="+encodeURIComponent(n.data[r]);f+=u,f.length>i.limit?(n.post=!0,s(n)):(t.onreadystatechange=function(){t.readyState==4&&t.status==200&&n.callback(i.parseJSON(t.responseText))},n.credentials&&(t.withCredentials=n.credentials),t.onerror=n.serviceError,t.ontimeout=n.timeoutError,t.open("GET.html",f,!0),t.send())}function w(n){var t=i.create("script",{type:"text/javascript",async:"async"}),f=r.getElementsByTagName("head")[0],o=i.protocol+"//"+i.host+"/"+n.service+"/"+i.endpoint,u="",e;for(e in n.data)u+=(u?"&":"?")+e+"="+encodeURIComponent(n.data[e]);u+="&callback=pca.requests["+n.index+"].callback",t.src=o+u,t.onload=t.onreadystatechange=function(){this.readyState&&this.readyState!=="loaded"&&this.readyState!=="complete"||(t.onload=t.onreadystatechange=null,f&&t.parentNode&&f.removeChild(t))},t.src.length>i.limit?(n.post=!0,s(n)):f.insertBefore(t,f.firstChild)}function s(n){navigator.appName=="Microsoft Internet Explorer"?l(n):c(n)}function c(n){var t=new XMLHttpRequest,f=i.protocol+"//"+i.host+"/"+n.service+"/"+i.endpoint,r="",u;for(u in n.data)r+=(r?"&":"")+u+"="+encodeURIComponent(n.data[u]);t.onreadystatechange=function(){t.readyState==4&&t.status==200&&n.callback(i.parseJSON(t.responseText))},n.credentials&&(t.withCredentials=n.credentials),t.onerror=n.serviceError,t.ontimeout=n.timeoutError,t.open("POST.html",f,!0),t.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t.send(r)}function l(n){function o(n,t){var i=r.createElement("input");i.name=n,i.value=t,u.appendChild(i)}var u=r.createElement("form"),t=r.createElement("iframe"),s=!1,e,f;u.method="POST",u.action=i.protocol+"//"+i.host+"/"+n.service+"/json.ws";for(e in n.data)o(e,n.data[e]);o("CallbackVariable","window.name"),o("CallbackWithScriptTags","true"),t.onload=function(){s?(n.callback({Items:i.parseJSON(t.contentWindow.name)}),r.body.removeChild(t)):(s=!0,t.contentWindow.location="about:blank")},t.style.display="none",r.body.appendChild(t),f=t.contentDocument||t.contentWindow.document,f.body?f.body.appendChild(u):f.appendChild(u),u.submit()}function u(t){return t==n||t==r||t==r.body}var i=n.pca=n.pca||{},r=n.document,f,o;i.protocol=(n.location||r.location).protocol=="https:"?"https:":"http:",i.host="services.postcodeanywhere.co.uk",i.endpoint="json3ex.ws",i.limit=2e3,i.synonyms=[{r:/\bN(?=\s)/,w:"NORTH"},{r:/\b(?:NE|NORTHEAST)(?=\s)/,w:"NORTH EAST"},{r:/\b(?:NW|NORTHWEST)(?=\s)/,w:"NORTH WEST"},{r:/\bS(?=\s)/,w:"SOUTH"},{r:/\b(?:SE|SOUTHEAST)(?=\s)/,w:"SOUTH EAST"},{r:/\b(?:SW|SOUTHWEST)(?=\s)/,w:"SOUTH WEST"},{r:/\bE(?=\s)/,w:"EAST"},{r:/\bW(?=\s)/,w:"WEST"},{r:/\bST(?=\s)/,w:"SAINT"}],i.diacritics=[{r:/[¿¡¬√]/gi,w:"A"},{r:/≈/gi,w:"AA"},{r:/[∆Êƒ]/gi,w:"AE"},{r:/«/gi,w:"C"},{r:/–/gi,w:"DJ"},{r:/[»… À]/gi,w:"E"},{r:/[ÃÕœ]/gi,w:"I"},{r:/—/gi,w:"N"},{r:/[“”‘’]/gi,w:"O"},{r:/[åÿ÷]/gi,w:"OE"},{r:/ä/gi,w:"SH"},{r:/ﬂ/gi,w:"SS"},{r:/[Ÿ⁄€]/gi,w:"U"},{r:/‹/gi,w:"UE"},{r:/[ü›]/gi,w:"ZH"},{r:/-/gi,w:" "},{r:/[.,]/gi,w:""}],i.hypertext=[{r:/&/g,w:"&amp;"},{r:/"/g,w:"&quot;"},{r:/'/g,w:"&#39;"},{r:/</g,w:"&lt;"},{r:/>/g,w:"&gt;"}],i.requests=[],i.requestQueue=[],i.waitingRequest=!1,i.blockRequests=!1,i.styleFixes=[],i.agent=navigator&&navigator.userAgent||"",i.galaxyFix=/Safari\/534.30/.test(i.agent)&&/GT-I8190|GT-I9100|GT-I9305|GT-P3110/.test(i.agent),i.container=null,f=!1,o=[],i.fuzzyMatch=!0,i.fuzzyTags=["*"],i.ready=function(n){var i,t;if(f){if(o.length)for(i=o,o=[],t=0;t<i.length;t++)i[t]();n&&n()}else typeof n=="function"&&o.push(n)},i.Eventable=function(n){var t=n||this;return t.listeners={},t.listen=function(n,i){t.listeners[n]=t.listeners[n]||[],t.listeners[n].push(i)},t.ignore=function(n,i){if(t.listeners[n])for(var r=0;r<t.listeners[n].length;r++)if(t.listeners[n][r]===i){t.listeners[n].splice(r,1);break}},t.fire=function(n,i){var u,f,r;if(t.listeners[n])for(u=0;u<t.listeners[n].length;u++){for(f=[i],r=2;r<arguments.length;r++)f.push(arguments[r]);t.listeners[n][u].apply(t,f)}},t},i.Request=function(n,t,r,u){var f=new i.Eventable(this);f.service=n||"",f.data=t||{},f.success=r||function(){},f.error=u||function(){},f.response=null,f.cache=!!f.data.$cache,f.queue=!!f.data.$queue,f.block=!!f.data.$block,f.post=!!f.data.$post,f.credentials=!!f.data.$credentials,f.callback=function(n){f.response=n,y(f)},f.serviceError=function(n){f.error(n&&n.currentTarget&&n.currentTarget.statusText?"Webservice request error: "+n.currentTarget.statusText:"Webservice request failed.")},f.timeoutError=function(){f.error("Webservice request timed out.")},f.index=i.requests.length,i.requests.push(f)},i.fetch=function(n,t,r,u){h(new i.Request(n,t,r,u))},i.loadScript=function(n,t,u){var f=i.create("script",{type:"text/javascript"}),e=(u||r).getElementsByTagName("head")[0];f.onload=f.onreadystatechange=function(){this.readyState&&this.readyState!=="loaded"&&this.readyState!=="complete"||(f.onload=f.onreadystatechange=null,(t||function(){})())},f.src=(~n.indexOf("../index.html")?"":i.protocol+"//"+i.host+"/js/")+n,e.insertBefore(f,e.firstChild)},i.loadStyle=function(n,t,u){var f=i.create("link",{type:"text/css",rel:"stylesheet"}),e=(u||r).getElementsByTagName("head")[0];f.onload=f.onreadystatechange=function(){this.readyState&&this.readyState!=="loaded"&&this.readyState!=="complete"||(f.onload=f.onreadystatechange=null,(t||function(){})())},f.href=(~n.indexOf("../index.html")?"":i.protocol+"//"+i.host+"/css/")+n,e.insertBefore(f,e.firstChild)},i.Item=function(n,t){var r=new i.Eventable(this),u="pcaselected";return r.data=n,r.format=t,r.html=i.formatLine(n,t),r.title=n.title||i.removeHtml(r.html),r.tag=i.formatTag(n.tag||r.html),r.element=i.create("div",{className:"pcaitem",innerHTML:r.html,title:r.title}),r.visible=!0,r.highlight=function(){return i.addClass(r.element,u),r.fire("highlight"),r},r.lowlight=function(){return i.removeClass(r.element,u),r.fire("lowlight"),r},r.mouseover=function(){r.fire("mouseover")},r.mouseout=function(){r.fire("mouseout")},r.mousedown=function(){r.fire("mousedown")},r.mouseup=function(){r.fire("mouseup"),i.galaxyFix&&r.select()},r.click=function(){(r.fire("click"),i.galaxyFix)||r.select()},r.select=function(){return r.fire("select",r.data),r},r.hide=function(){return r.visible=!1,r.element.style.display="none",r.fire("hide"),r},r.show=function(){return r.visible=!0,r.element.style.display="",r.fire("show"),r},i.listen(r.element,"mouseover",r.mouseover),i.listen(r.element,"mouseout",r.mouseout),i.listen(r.element,"mousedown",r.mousedown),i.listen(r.element,"mouseup",r.mouseup),i.listen(r.element,"click",r.click),r},i.Collection=function(){var n=new i.Eventable(this);return n.items=[],n.highlighted=-1,n.count=0,n.firstItem=null,n.lastItem=null,n.firstItemClass="pcafirstitem",n.lastItemClass="pcalastitem",n.add=function(t,r,u){function o(t){var f=new i.Item(t,r);return f.listen("mouseover",function(){n.highlight(f)}),f.listen("select",function(t){n.fire("select",t),u(t)}),n.items.push(f),e.push(f),f}var e=[],f;if(u=u||function(){},t.length)for(f=0;f<t.length;f++)o(t[f]);else o(t);return n.count+=t.length,n.markItems(),n.fire("add",e),n},n.sort=function(t){return n.items.sort(function(n,i){return t?n.data[t]>i.data[t]?1:-1:n.tag>i.tag?1:-1}),n.fire("sort"),n},n.reverse=function(){return n.items.reverse(),n.fire("reverse"),n},n.filter=function(t){var u=i.formatTag(t),r=n.count;return n.count=0,n.all(function(t){~t.tag.indexOf(u)?(t.show(),n.count++):t.hide()}),r!=n.count&&n.fire("filter"),n},n.match=function(t){var u=i.formatTag(t),r=[];return n.all(function(n){~n.tag.indexOf(u)&&r.push(n)}),r},n.clear=function(){return n.items=[],n.count=0,n.highlighted=-1,n.firstItem=null,n.lastItem=null,n.fire("clear"),n},n.all=function(t){for(var i=0;i<n.items.length;i++)if(t(n.items[i],i)===!1)break;return n},n.highlight=function(t){return~n.highlighted&&n.items[n.highlighted].lowlight(),n.highlighted=n.index(t),~n.highlighted&&n.items[n.highlighted].highlight(),n.fire("highlight",t),n},n.index=function(t){for(var i=0;i<n.items.length;i++)if(n.items[i]==t)return i;return-1},n.first=function(t){for(var i=0;i<n.items.length;i++)if(t?t(n.items[i]):n.items[i].visible)return n.items[i];return null},n.last=function(t){for(var i=n.items.length-1;i>=0;i--)if(t?t(n.items[i]):n.items[i].visible)return n.items[i];return null},n.next=function(t){for(var i=n.highlighted+1;i<n.items.length;i++)if(t?t(n.items[i]):n.items[i].visible)return n.items[i];return n.first()},n.previous=function(t){for(var i=n.highlighted-1;i>=0;i--)if(t?t(n.items[i]):n.items[i].visible)return n.items[i];return n.last()},n.markItems=function(){n.firstItem&&i.removeClass(n.firstItem.element,n.firstItemClass),n.lastItem&&i.removeClass(n.lastItem.element,n.lastItemClass),n.items.length&&(n.firstItem=n.items[0],n.lastItem=n.items[n.items.length-1],i.addClass(n.firstItem.element,n.firstItemClass),i.addClass(n.lastItem.element,n.lastItemClass))},n},i.List=function(t){var r=new i.Eventable(this);return r.options=t||{},r.element=i.create("div",{className:"pca pcalist"}),r.collection=new i.Collection,r.visible=!0,r.scroll={held:!1,moved:!1,origin:0,position:0,x:0,y:0,dx:0,dy:0},r.show=function(){return r.visible=!0,r.element.style.display="",r.fire("show"),r},r.hide=function(){return r.visible=!1,r.element.style.display="none",r.fire("hide"),r},r.draw=function(){return r.destroy(),r.collection.all(function(n){r.element.appendChild(n.element)}),r.fire("draw"),r},r.add=function(n,t,i){return r.collection.add(n,t,i),r.draw(),r},r.destroy=function(){while(r.element.childNodes&&r.element.childNodes.length)r.element.removeChild(r.element.childNodes[0]);return r},r.clear=function(){return r.collection.clear(),r.destroy(),r.fire("clear"),r},r.setScroll=function(n){return r.element.scrollTop=n,r.fire("scroll"),r},r.enableTouch=function(){function f(t){t=t||n.event,r.scroll.held=!0,r.scroll.moved=!1,r.scroll.origin=parseInt(r.scrollTop),r.scroll.y=parseInt(t.touches[0].pageY)}function e(){r.scroll.held=!1}function t(){r.scroll.held=!1}function u(t){r.scroll.held&&(t=t||n.event,i.smash(t),r.scroll.dy=r.scroll.y-parseInt(t.touches[0].pageY),r.scroll.position=r.scroll.origin+r.scroll.dy,r.setScroll(r.scroll.position),r.scroll.moved=!0)}return i.listen(r.element,"touchstart",f),i.listen(r.element,"touchmove",u),i.listen(r.element,"touchend",e),i.listen(r.element,"touchcancel",t),r},r.move=function(n){return n&&(r.collection.highlight(n),r.scrollToItem(n)),r},r.next=function(){return r.move(r.collection.next())},r.previous=function(){return r.move(r.collection.previous())},r.first=function(){return r.move(r.collection.first())},r.last=function(){return r.move(r.collection.last())},r.firstItem=function(){return r.collection.first()},r.currentItem=function(){return r.collection.items[r.collection.highlighted]},r.selectable=function(){return r.visible&&!!r.currentItem()},r.select=function(){return r.selectable()&&r.currentItem().select(),r},r.navigate=function(n){switch(n){case 40:return r.next(),!0;case 38:return r.previous(),!0;case 13:if(r.selectable())return r.select(),!0}return!1},r.scrollToItem=function(n){return r.scroll.position=r.element.scrollTop,n.element.offsetTop<r.scroll.position?(r.scroll.position=n.element.offsetTop,r.setScroll(r.scroll.position)):n.element.offsetTop+n.element.offsetHeight>r.scroll.position+r.element.offsetHeight&&(r.scroll.position=n.element.offsetTop+n.element.offsetHeight-r.element.offsetHeight,r.setScroll(r.scroll.position)),r},r.filter=function(n){var t=r.collection.count;return r.collection.filter(n),t!=r.collection.count&&r.fire("filter",n),r},r.collection.listen("add",function(n){r.fire("add",n)}),r.options.name&&(i.setAttributes(r.element,{id:r.options.name,role:"listbox","aria-activedescendant":""}),r.collection.listen("add",function(n){function u(n){n.listen("highlight",function(){i.setAttributes(r.element,{"aria-activedescendant":n.id})})}for(var t=0;t<n.length;t++)u(n[t]);r.collection.all(function(n,t){n.element.id=n.id=r.options.name+"_item"+t,i.setAttributes(n.element,{role:"option"})})})),r},i.AutoComplete=function(t,f){var e=new i.Eventable(this);return e.options=f||{},e.element=i.create("div",{className:"pcaautocomplete pcatext"}),e.anchors=[],e.list=new i.List(e.options),e.fieldListeners=[],e.field=null,e.positionField=null,e.visible=!0,e.hover=!1,e.focused=!1,e.controlDown=!1,e.disabled=!1,e.fixedWidth=!1,e.emptyMessage=e.options.emptyMessage||"",e.skipFilter=!1,e.header={element:i.create("div",{className:"pcaheader"}),headerText:i.create("div",{className:"pcamessage"}),init:function(){this.hide()},setContent:function(n){return n=n||"",typeof n=="string"?this.element.innerHTML=n:this.element.appendChild(n),e.fire("header"),this},setText:function(n){return n=n||"",this.element.appendChild(this.headerText),typeof n=="string"?(i.clear(this.headerText),this.headerText.appendChild(i.create("span",{className:"pcamessageicon"})),this.headerText.appendChild(i.create("span",{innerHTML:n}))):this.headerText.appendChild(n),e.fire("header"),this},clear:function(){return this.setContent(),e.fire("header"),this},show:function(){return this.element.style.display="",e.fire("header"),this},hide:function(){return this.element.style.display="none",e.fire("header"),this}},e.footer={element:i.create("div",{className:"pcafooter"}),init:function(){this.hide()},setContent:function(n){return n=n||"",typeof n=="string"?this.element.innerHTML=n:this.element.appendChild(n),e.fire("footer"),this},show:function(){return this.element.style.display="",e.fire("footer"),this},hide:function(){return this.element.style.display="none",e.fire("footer"),this}},e.load=function(){if(t.length&&t.constructor==Array)for(var u=0;u<t.length;u++)e.attach(i.getElement(t[u]));else e.attach(i.getElement(t));return i.listen(e.element,"mouseover",function(){e.hover=!0}),i.listen(e.element,"mouseout",function(){e.hover=!1}),i.listen(r,"click",e.checkHide),i.listen(n,"resize",e.resize),(r.documentMode&&r.documentMode<=7||/\bMSIE (7|6)/.test(i.agent))&&e.setWidth(280),r.documentMode&&r.documentMode<=5&&(i.applyStyleFixes(".pca .pcafooter",{fontSize:"0pt"}),i.applyStyleFixes(".pca .pcaflag",{fontSize:"0pt"})),e},e.attach=function(n){function t(n,t,r){i.listen(n,t,r),e.fieldListeners.push({field:n,event:t,action:r})}function f(n){function f(){o.appendChild(e.element),e.focus(n)}var u=i.create("table",{className:"pca pcaanchor",cellPadding:0,cellSpacing:0}),s=[u.insertRow(0).insertCell(0),u.insertRow(1).insertCell(0)],o=i.create("div",{className:"pcachain"});if(!n||!n.tagName){i.append(e.element);return}n.parentNode.insertBefore(u,n),s[0].appendChild(n),s[1].appendChild(o),e.anchors.push(u),i.inputField(n)&&(t(n,"keyup",e.keyup),t(n,"keydown",e.keydown),t(n,"focus",f),t(n,"blur",e.blur),t(n,"keypress",e.keypress),n==r.activeElement&&f()),t(n,"click",function(){e.click(n)}),t(n,"dblclick",function(){e.dblclick(n)}),t(n,"change",function(){e.change(n)})}function u(n){function u(){e.focus(n)}(i.append(e.element),n&&n.tagName)&&(i.inputField(n)&&(t(n,"keyup",e.keyup),t(n,"keydown",e.keydown),t(n,"focus",u),t(n,"blur",e.blur),t(n,"keypress",e.keypress),n==r.activeElement&&u()),t(n,"click",function(){e.click(n)}),t(n,"dblclick",function(){e.dblclick(n)}),t(n,"change",function(){e.change(n)}))}e.options.force?f(n):u(n)},e.position=function(t){var o=i.getPosition(t),c=i.getSize(t),a=i.getTopOffsetParent(t),h=i.getParentScroll(t),s=i.getSize(e.element),v=i.getSize(n),r=i.getScroll(n),f=!u(a),l;return o.top-(f?0:r.top)>s.height&&o.top+s.height-(f?0:r.top)>v.height?e.options.force?e.element.style.top=-(s.height+c.height+2)+"px":(e.element.style.top=o.top-h.top-s.height+(f?r.top:0)+"px",e.element.style.left=o.left-h.left+(f?r.left:0)+"px"):e.options.force?e.element.style.top="auto":(e.element.style.top=o.top-h.top+c.height+1+(f?r.top:0)+"px",e.element.style.left=o.left-h.left+(f?r.left:0)+"px"),e.fixedWidth||(l=parseInt(i.getStyle(e.element,"borderLeftWidth"))+parseInt(i.getStyle(e.element,"borderRightWidth"))||0,e.element.style.minWidth=Math.max(i.getSize(t).width-l,0)+"px"),e.options.left&&(e.element.style.left=parseInt(e.element.style.left)+parseInt(e.options.left)+"px"),e.options.top&&(e.element.style.top=parseInt(e.element.style.top)+parseInt(e.options.top)+"px"),e.positionField=t,e.fire("move"),e},e.reposition=function(){return e.positionField&&e.position(e.positionField),e},e.prompt=function(n,t){if(typeof t=="number"){if(t==0?n=" "+n:t>=n.length?(n=n+" ",t++):(n=n.substring(0,t)+"  "+n.substring(t,n.length),t++),i.setValue(e.field,n),e.field.setSelectionRange)e.field.setSelectionRange(t,t);else if(e.field.createTextRange){var r=e.field.createTextRange();r.move("character",t),r.select()}}else i.setValue(e.field,n);return e},e.show=function(){return e.disabled||(e.visible=!0,e.element.style.display="",e.list.collection.count?(e.options.emptyMessage&&e.header.clear().hide(),e.list.show()):(e.options.emptyMessage&&e.header.setText(e.options.emptyMessage).show(),e.list.hide()),e.setScroll(0),e.reposition(),e.fire("show")),e},e.showAll=function(){e.list.filter(""),e.show()},e.hide=function(){return e.visible=!1,e.element.style.display="none",e.fire("hide"),e},e.focus=function(n){e.field=n,e.focused=!0,e.show(),e.position(n),e.fire("focus")},e.blur=function(){e.focused=!1,e.checkHide(),e.fire("blur")},e.checkHide=function(){return!e.visible||e.focused||e.hover||e.hide(),e},e.handleKey=function(n,t){n==27?(e.hide(),e.fire("escape")):n==17?e.controlDown=!1:n==8||n==46?(e.filter(),e.fire("delete")):n!=0&&n<=46?e.visible&&e.list.navigate(n)?t&&i.smash(t):(n==38||n==40)&&e.filter():e.visible&&e.filter(),e.fire("keyup",n)},e.keydown=function(t){t=t||n.event;var i=t.which||t.keyCode;i==17&&(e.controlDown=!0)},e.keyup=function(t){t=t||n.event;var i=t.which||t.keyCode;e.handleKey(i,t)},e.keypress=function(t){var r=n.event?n.event.keyCode:t.which;e.visible&&r==13&&e.list.selectable()&&i.smash(t)},e.click=function(n){e.fire("click",n)},e.dblclick=function(n){e.fire("dblclick",n)},e.change=function(n){e.fire("change",n)},e.resize=function(){e.visible&&e.reposition()},e.add=function(n,t,i){return e.list.add(n,t,i),e},e.clear=function(){return e.list.clear(),e},e.setScroll=function(n){return e.list.setScroll(n),e},e.setWidth=function(n){return typeof n=="number"?(n=Math.max(n,220),e.element.style.width=n+"px",r.documentMode&&r.documentMode<=5&&(n-=2),e.list.element.style.width=n+"px"):(e.element.style.width=n,e.list.element.style.width=n),e.fixedWidth=n!="auto",e.element.style.minWidth=0,e},e.setHeight=function(n){return e.list.element.style.height=typeof n=="number"?n+"px":n,e},e.filter=function(n){return n=n||i.getValue(e.field),e.skipFilter?e.list.collection.match(n).length<e.list.collection.count&&e.list.fire("filter"):(e.list.filter(n,e.skipFilter),n&&!e.list.collection.count&&!e.skipFilter&&!e.options.emptyMessage?e.hide():e.show()),e.fire("filter",n),e},e.disable=function(){return e.disabled=!0,e},e.enable=function(){return e.disabled=!1,e},e.destroy=function(){i.remove(e.element),i.ignore(r,"click",e.checkHide);for(var n=0;n<e.fieldListeners.length;n++)i.ignore(e.fieldListeners[n].field,e.fieldListeners[n].event,e.fieldListeners[n].action)},e.element.appendChild(e.header.element),e.element.appendChild(e.list.element),e.element.appendChild(e.footer.element),e.header.init(),e.footer.init(),t&&e.load(t),e.options.width&&e.setWidth(e.options.width),e.options.height&&e.setHeight(e.options.height),e.options.className&&i.addClass(e.element,e.options.className),e.field||e.hide(),e},i.Modal=function(n){function u(n){return n=n||{},n.type=n.type||"text",n}var t=new i.Eventable(this);return t.options=n||{},t.element=i.create("div",{className:"pcamodal"}),t.border=i.create("div",{className:"pcaborder"}),t.frame=i.create("div",{className:"pcaframe"}),t.content=i.create("div",{className:"pcacontent pcatext"}),t.mask=i.create("div",{className:"pcafullscreen pcamask"}),t.form=[],t.header={element:i.create("div",{className:"pcaheader"}),headerText:i.create("div",{className:"pcatitle"},t.options.titleStyle||""),init:function(){this.setText(t.options.title||"")},setContent:function(n){return n=n||"",typeof n=="string"?this.element.innerHTML=n:this.element.appendChild(n),t.fire("header"),this},setText:function(n){return n=n||"",this.element.appendChild(this.headerText),typeof n=="string"?this.headerText.innerHTML=n:this.headerText.appendChild(n),t.fire("header"),this},show:function(){return this.element.style.display="",t.fire("header"),this},hide:function(){return this.element.style.display="none",t.fire("header"),this}},t.footer={element:i.create("div",{className:"pcafooter"}),setContent:function(n){return n=n||"",typeof n=="string"?this.element.innerHTML=n:this.element.appendChild(n),t.fire("footer"),this},show:function(){return this.element.style.display="",t.fire("header"),this},hide:function(){return this.element.style.display="none",t.fire("header"),this}},t.setTitle=function(n){t.header.setText(n).show()},t.setContent=function(n){return typeof n=="string"?t.content.innerHTML=n:t.content.appendChild(n),t.fire("change"),t},t.addField=function(n,r){r=u(r);var e=i.create("div",{className:"pcainputrow"}),f=i.create(r.tag||"input",r),o=i.create("label",{htmlFor:f.id||"",innerHTML:n||""});return e.appendChild(o),e.appendChild(f),t.setContent(e),t.form.push({label:n,element:f}),f},t.addHalfFields=function(n,r,f){r=u(r),f=u(f);var s=i.create("div",{className:"pcainputrow"}),e=i.create(r.tag||"input",r),o=i.create(f.tag||"input",f),h=i.create("label",{htmlFor:e.id||"",innerHTML:n||""});return i.addClass(e,"pcahalf"),i.addClass(o,"pcahalf"),s.appendChild(h),s.appendChild(e),s.appendChild(o),t.setContent(s),t.form.push({label:"First "+n,element:e}),t.form.push({label:"Second "+n,element:o}),[e,o]},t.addButton=function(n,u,f){function o(){for(var r={},n=0;n<t.form.length;n++)r[t.form[n].label]=i.getValue(t.form[n].element);u(r)}var e=i.create("input",{type:"button",value:n,className:"pcabutton"});return!f||r.documentMode&&r.documentMode<=7||(e.style.float="right"),i.listen(e,"click",o),t.footer.setContent(e),e},t.centre=function(){var n=i.getSize(t.element);return t.element.style.marginTop=-(n.height/2)+"px",t.element.style.marginLeft=-(n.width/2)+"px",t},t.show=function(){return r.documentMode&&r.documentMode<=5||/\bMSIE 6/.test(i.agent)||(t.element.style.display="",t.mask.style.display="",t.centre(),t.fire("show")),t},t.hide=function(){return t.element.style.display="none",t.mask.style.display="none",t.fire("hide"),t},i.listen(t.mask,"click",t.hide),t.element.appendChild(t.border),t.element.appendChild(t.frame),t.frame.appendChild(t.header.element),t.frame.appendChild(t.content),t.frame.appendChild(t.footer.element),t.header.init(),i.append(t.mask),i.append(t.element),t.hide(),t},i.Tooltip=function(t,r){var f=new i.Eventable(this);return f.element=i.create("div",{className:"pcatooltip"}),f.background=i.create("div",{className:"pcabackground"}),f.message=i.create("div",{className:"pcamessage",innerText:r}),f.show=function(){return f.element.style.display="",f.position(),f.fire("show"),f},f.hide=function(){return f.element.style.display="none",f.fire("hide"),f},f.setMessage=function(n){i.setValue(f.message,n)},f.position=function(){var h=i.getPosition(t),a=i.getSize(t),v=i.getTopOffsetParent(t),s=i.getSize(f.message),l=i.getSize(n),o=i.getScroll(n),c=!u(v),r=h.top-s.height-5+(c?o.top:0),e=h.left+a.width/2-s.width/2+(c?o.left:0);r=Math.min(r,l.height+o.top-s.height),r=Math.max(r,0),e=Math.min(e,l.width+o.left-s.width),e=Math.max(e,0),f.element.style.top=r+"px",f.element.style.left=e+"px"},(t=i.getElement(t))&&(i.listen(t,"mouseover",f.show),i.listen(t,"mouseout",f.hide)),f.element.appendChild(f.background),f.element.appendChild(f.message),f.setMessage(r),i.append(f.element),f.hide(),f},i.formatLine=function(n,t){function i(t){return(typeof n[t]=="function"?n[t]():n[t])||""}return t=t.replace(/\{([^\}]*\{(\w+)\}[^\}]*)\}/g,function(n,t,r){var u=i(r);return u?t.replace(/\{(\w+)\}/g,u):""}),t.replace(/\{(\w+)\}/g,function(n,t){return i(t)})},i.formatTag=function(n){return n?i.replaceList(i.replaceList(i.removeHtml(n.toUpperCase()),i.diacritics),i.synonyms):""},i.formatTagWords=function(n){return i.formatTag(n).split(" ")},i.formatCamel=function(n,t){function i(n,i,r){return i+t+r}return t=t||" ",n=n.replace(/([a-z])([A-Z0-9])/g,i),n=n.replace(/([0-9])([A-Z])/g,i),n=n.replace(/([A-Z])([A-Z][a-z])/g,i)},i.replaceList=function(n,t){for(var i=0;i<t.length;i++)n=n.toString().replace(t[i].r,t[i].w);return n},i.removeHtml=function(n){return n.replace(/<(?:.|\s)*?>+/g,"")},i.escapeHtml=function(n){return i.replaceList(n,i.hypertext)},i.validId=function(n){return/[a-z0-9-_:\.\[\]]+/gi.exec(n)},i.trimSpaces=function(n){return n.replace(/^\s+|\s(?=\s)|\s$/g,"")},i.tidy=function(n,t){t=t.replace("\\","\\\\");var i=new RegExp("^"+t+"+|"+t+"(?="+t+")|"+t+"$","gi");return n.replace(i,"")},i.getText=function(n){return/[a-zA-Z][a-zA-Z\s]+[a-zA-Z]/.exec(n)},i.getNumber=function(n){return/\d+/.exec(n)},i.parseJSON=function(n){return n&&/^[\],:{}\s]*$/.test(n.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))?typeof JSON!="undefined"?JSON.parse(n):eval(n):{}},i.parseJSONDate=function(n){return new Date(parseInt(i.getNumber(n)))},i.containsWord=function(n,t){var i=new RegExp("\\b"+t+"\\b","gi");return i.test(n)},i.removeWord=function(n,t){var i=new RegExp("\\s?\\b"+t+"\\b","gi");return n.replace(i,"")},i.merge=function(n,t){for(var i in n)t[i]||(t[i]=n[i]);return t},i.getElement=function(n,t){var f,u;if(!n)return null;if(typeof n.nodeType=="number")return n;if(typeof n=="string"){if(t=i.getElement(t)||r,f=t.getElementById?t.getElementById(n):null,f)return f;if(u=t.getElementsByName?t.getElementsByName(n):null,u.length)return u[0]}return i.fuzzyMatch?i.getElementByRegex(n,t):null},i.getElementByRegex=function(n,t){var e,o,u,f;if(typeof n=="string")try{n=new RegExp(n)}catch(s){return null}if(n&&typeof n=="object"&&n.constructor==RegExp)for(t=i.getElement(t)||r,e=0;e<i.fuzzyTags.length;e++)for(o=t.getElementsByTagName(i.fuzzyTags[e]),u=0;u<o.length;u++)if(f=o[u],f.id&&n.test(f.id))return f;return null},i.getValue=function(n){if(n=i.getElement(n)){if(n.tagName=="INPUT"||n.tagName=="TEXTAREA")return n.type=="checkbox"?n.checked:n.value;if(n.tagName=="SELECT")return n.selectedIndex>=0?n.options[n.selectedIndex].value:"";if(n.tagName=="DIV"||n.tagName=="SPAN"||n.tagName=="TD")return n.innerHTML}return""},i.setValue=function(n,t){var u,f,r;if((t||t=="")&&(n=i.getElement(n)))if(u=t.toString(),f=u.toLowerCase(),n.tagName=="INPUT")n.type=="checkbox"?n.checked=typeof t=="boolean"&&t||f=="true":n.value=i.tidy(u.replace(/\n/g,", "),", ");else if(n.tagName=="TEXTAREA")n.value=u;else if(n.tagName=="SELECT"){for(r=0;r<n.options.length;r++)if(n.options[r].value.toLowerCase()==f||n.options[r].text.toLowerCase()==f){n.selectedIndex=r;return}}else(n.tagName=="DIV"||n.tagName=="SPAN"||n.tagName=="TD")&&(n.innerHTML=u.replace(/\n/g,"<br/>"))},i.inputField=function(n){return(n=i.getElement(n))?n.tagName&&(n.tagName=="INPUT"||n.tagName=="TEXTAREA")&&n.type&&(n.type=="text"||n.type=="search"||n.type=="email"||n.type=="textarea"):!1},i.selectList=function(n){return(n=i.getElement(n))?n.tagName&&n.tagName=="SELECT":!1},i.checkBox=function(n){return(n=i.getElement(n))?n.tagName&&n.tagName=="INPUT"&&n.type&&n.type=="checkbox":!1},i.clear=function(n){i.setValue(n,"")},i.getPosition=function(t){var e={left:0,top:0},f,r;if(t=i.getElement(t)){if(!t.tagName)return e;if(typeof t.getBoundingClientRect!="undefined"){var h=t.getBoundingClientRect(),o=!u(i.getTopOffsetParent(t)),c=i.getScroll(n),s=i.getParentScroll(t);return{left:h.left+s.left+(o?0:c.left),top:h.top+s.top+(o?0:c.top)}}f=0,r=0;do f+=t.offsetLeft,r+=t.offsetTop;while(t=t.offsetParent);return{left:f,top:r}}return e},i.getScroll=function(n){return{left:parseInt(n.scrollX||n.scrollLeft,10)||(u(n)?parseInt(r.documentElement.scrollLeft)||0:0),top:parseInt(n.scrollY||n.scrollTop,10)||(u(n)?parseInt(r.documentElement.scrollTop)||0:0)}},i.getSize=function(n){return{height:n.offsetHeight||n.innerHeight||(u(n)?r.documentElement.clientHeight||r.body.clientHeight:0),width:n.offsetWidth||n.innerWidth||(u(n)?r.documentElement.clientWidth||r.body.clientWidth:0)}},i.getParentScroll=function(n){var f={left:0,top:0},r,t;if(n=i.getElement(n)){if(!n.tagName||!(n=n.parentNode))return f;r=0,t=0;do{if(u(n))break;r+=parseInt(n.scrollLeft),t+=parseInt(n.scrollTop)}while(n=n.parentNode);return{left:r,top:t}}return f},i.getTopOffsetParent=function(n){while(n.offsetParent)if(n=n.offsetParent,i.getStyle(n,"position")=="fixed")break;return n},i.getStyle=function(t,i){return((n.getComputedStyle?n.getComputedStyle(t):t.currentStyle)||{})[i]||""},i.addClass=function(n,t){(n=i.getElement(n))&&(i.containsWord(n.className||"",t)||(n.className+=(n.className?" ":"")+t))},i.removeClass=function(n,t){(n=i.getElement(n))&&(n.className=i.removeWord(n.className,t))},i.setAttributes=function(n,t){for(var i in t)n.setAttribute(i,t[i])},i.applyStyleFixes=function(n,t){for(var h,u,f,s,o,e=0;e<r.styleSheets.length;e++){h=r.styleSheets[e],u=[];try{u=h.rules||h.cssRules||[]}catch(c){}for(f=0;f<u.length;f++)if(s=u[f],s.selectorText.toLowerCase()==n)for(o in t)s.style[o]=t[o]}i.styleFixes.push({selectorText:n,fixes:t})},i.reapplyStyleFixes=function(){var t=i.styleFixes,n;for(i.styleFixes=[],n=0;n<t.length;n++)i.applyStyleFixes(t[n].selectorText,t[n].fixes)},i.createStyleSheet=function(n){r.createStyleSheet?r.createStyleSheet().cssText=n:r.head.appendChild(i.create("style",{type:"text/css",innerHTML:n}))},i.create=function(n,t,i){var f=r.createElement(n),u;for(u in t||{})f[u]=t[u];return i&&(f.style.cssText=i),f},i.append=function(n){i.container||(i.container=i.create("div",{className:"pca"}),r.body.appendChild(i.container)),i.container.appendChild(n)},i.remove=function(n){n&&n.parentNode&&n.parentNode==i.container&&i.container.removeChild(n)},i.listen=function(t,i,r,u){n.addEventListener?t.addEventListener(i,r,u):t.attachEvent("on"+i,r)},i.fire=function(n,t){if(r.createEvent){var i=r.createEvent("HTMLEvents");return i.initEvent(t,!0,!0),!n.dispatchEvent(i)}return n.fireEvent("on"+t,r.createEventObject())},i.ignore=function(t,i,r){n.removeEventListener?t.removeEventListener(i,r):t.detachEvent("on"+i,r)},i.smash=function(t){var i=t||n.event;i.stopPropagation?i.stopPropagation():i.cancelBubble=!0,i.preventDefault?i.preventDefault():i.returnValue=!1},i.debug=function(n){typeof console!="undefined"&&console.debug&&console.debug(n),i.setValue(r.getElementById("pcadebug"),n)},v()})(window);
(function(){var n=window.pca=window.pca||{};n.countries=[
	{ iso2: "GB", iso3: "GBR", name: "United Kingdom", alternates: [ "Britain", "England", "Great Britain", "Northern Ireland", "Scotland", "UK", "Wales" ], flag: 78 }],n.countryNameType={NAME:0,ISO2:1,ISO3:2},n.CountryList=function(t,i){var r=new n.Eventable(this);r.fields=t||[],r.options=i||{},r.options.defaultCode=r.options.defaultCode||"",r.options.value=r.options.value||"",r.options.codesList=r.options.codesList||"",r.options.fillOthers=r.options.fillOthers||!1,r.options.list=r.options.list||{},r.options.populate=typeof r.options.populate=="boolean"?r.options.populate:!0,r.options.prepopulate=typeof r.options.prepopulate=="boolean"?r.options.prepopulate:!0,r.options.nameType=r.options.nameType||n.countryNameType.NAME,r.options.valueType=r.options.valueType||n.countryNameType.ISO3,r.options.fallbackCode=r.options.fallbackCode||"GBR",r.template="<div class='pcaflag'></div><div class='pcaflaglabel'>{name}</div>",r.autocomplete=new n.AutoComplete(r.fields,r.options.list),r.country=null,r.textChanged=!1,r.load=function(){function c(t){r.setCountry(n.getValue(t)),r.textChanged=!1}var h,t,f,s,i,u,o,e;if(n.addClass(r.autocomplete.element,"pcacountrylist"),r.options.codesList){for(h=r.options.codesList.replace(/\s/g,"").split(","),t=[],r.autocomplete.clear(),f=0;f<h.length;f++)for(s=h[f].toString().toUpperCase(),i=0;i<n.countries.length;i++)if(n.countries[i].iso2==s||n.countries[i].iso3==s){t.push(n.countries[i]);break}if(r.options.fillOthers)for(u=0;u<n.countries.length;u++){for(o=!1,e=0;e<t.length;e++)n.countries[u].iso3==t[e].iso3&&(o=!0);o||t.push(n.countries[u])}r.autocomplete.clear().add(t,r.template,r.change)}else r.autocomplete.clear().add(n.countries,r.template,r.change);r.autocomplete.list.collection.all(function(t){r.setFlagPosition(t.element.firstChild,t.data.flag),t.tag+=" "+n.formatTag(t.data.iso3+(t.data.alternates?" "+t.data.alternates.join(" "):""))}),r.autocomplete.listen("focus",function(){r.autocomplete.showAll()}),r.autocomplete.listen("change",function(n){r.autocomplete.visible?r.textChanged=!0:c(n)}),r.autocomplete.listen("hide",function(){r.textChanged&&c(r.autocomplete.field)}),r.options.value&&(r.country=r.find(r.options.value)),!r.country&&r.options.defaultCode&&(r.country=r.find(r.options.defaultCode)),r.country=r.country||(r.options.codesList?r.first():r.find(r.options.fallbackCode))||r.first()||r.find(r.options.fallbackCode),r.fire("load")},r.getName=function(t){switch(r.options.nameType){case n.countryNameType.NAME:return(t||r.country).name;case n.countryNameType.ISO2:return(t||r.country).iso2;case n.countryNameType.ISO3:return(t||r.country).iso3}return(t||r.country).name},r.getValue=function(t){switch(r.options.valueType){case n.countryNameType.NAME:return(t||r.country).name;case n.countryNameType.ISO2:return(t||r.country).iso2;case n.countryNameType.ISO3:return(t||r.country).iso3}return(t||r.country).iso3},r.populate=function(){var e,f,i,t,u;if(r.options.populate){for(e=r.getName(),f=r.getValue(),i=0;i<r.fields.length;i++)t=n.getElement(r.fields[i]),u=n.getValue(t),n.setValue(t,n.selectList(t)?f:e),r.options.prepopulate&&u!=n.getValue(t)&&n.fire(t,"change");r.fire("populate")}},r.find=function(n){function t(t){if(t.data.alternates)for(var i=0;i<t.data.alternates.length;i++)if(t.data.alternates[i].toUpperCase()==n)return!0;return!1}return n=n.toString().toUpperCase(),(r.autocomplete.list.collection.first(function(i){return i.data.iso2.toUpperCase()==n||i.data.iso3.toUpperCase()==n||i.data.name.toUpperCase()==n||t(i)})||{}).data},r.first=function(){return r.autocomplete.list.collection.first().data},r.change=function(n){n&&(r.country=n,r.populate(),r.textChanged=!1,r.fire("change",r.country))},r.setFlagPosition=function(n,t){n.style.backgroundPosition="-1px -"+(t*16+2)+"px"},r.flag=function(){function t(n){r.setFlagPosition(i,n.flag)}var i=n.create("div",{className:"pcaflag"});return t(r.country),r.listen("change",t),i},r.setCountry=function(n){return r.change(r.find(n)),r},r.setCountryByIP=function(t){function i(n){n.length&&n[0].Iso3&&r.setCountry(n[0].Iso3)}t&&n.fetch("Extras/Web/Ip2Country/v1.10",{Key:t},i)},r.load()}})();
(function(){var n=window.pca=window.pca||{};n.fieldMode={DEFAULT:3,NONE:0,SEARCH:1,POPULATE:2,PRESERVE:4,COUNTRY:8},n.Address=function(t,i){function u(){r.lastActionTimer!=null&&(window.clearTimeout(r.lastActionTimer),r.lastActionTimer=null)}function f(){r.reset(),r.autocomplete.show(),r.autocomplete.header.clear().setContent(n.create("div",{className:"pcamessage",innerHTML:r.messages[r.language].NORESULTS,onclick:r.options.manualEntry?r.manualEntry:function(){}},r.options.manualEntry?"cursor:pointer;":"")).show(),r.showFooterMessage(),r.autocomplete.clear().list.hide(),r.fire("noresults")}var r=new n.Eventable(this);r.messages={en:{DIDYOUMEAN:"Did you mean:",NORESULTS:"No results found",KEEPTYPING:"Keep typing your address to display more results",RETRIEVEERROR:"Record could not be retrieved",SERVICEERROR:"Service Error:",COUNTRYSELECT:"Select Country",NOLOCATION:"Sorry, we could not get your location",NOCOUNTRY:"Sorry, we could not find this country"},cy:{DIDYOUMEAN:"A oeddech yn meddwl:",NORESULTS:"Dim canlyniadau ar ganlyniadau",KEEPTYPING:"Cadwch teipio eich cyfeiriad i arddangos mwy o ganlyniadau",RETRIEVEERROR:"Ni allai cofnod yn cael ei hadalw",SERVICEERROR:"Gwall gwasanaeth:",COUNTRYSELECT:"Dewiswch gwlad",NOLOCATION:"Mae'n ddrwg gennym, nid oeddem yn gallu cael eich lleoliad",NOCOUNTRY:"Mae'n ddrwg gennym, ni allem ddod o hyd y wlad hon"},fr:{DIDYOUMEAN:"Vouliez-vous dire:",NORESULTS:"Aucun rÈsultat n'a ÈtÈ trouvÈ",KEEPTYPING:"Continuer ‡ taper votre adresse pour afficher plus de rÈsultats",RETRIEVEERROR:"Enregistrement n'a pas pu Ítre rÈcupÈrÈ",SERVICEERROR:"Erreur de service:",COUNTRYSELECT:"Changer de pays",NOLOCATION:"DÈsolÈ, nous n'avons pas pu obtenir votre emplacement",NOCOUNTRY:"DÈsolÈ, nous n'avons pas trouvÈ ce pays"},de:{DIDYOUMEAN:"Meinten Sie:",NORESULTS:"Keine Adressen gefunden",KEEPTYPING:"Halten Sie Ihre Adresse eingeben, um weitere Ergebnisse anzuzeigen",RETRIEVEERROR:"Die Bilanz konnte nicht abgerufen werden",SERVICEERROR:"Service-Fehler:",COUNTRYSELECT:"Land wechseln",NOLOCATION:"Leider konnten wir nicht bekommen, Ihren Standort",NOCOUNTRY:"Leider konnten wir nicht finden, dieses Land"}},r.searchMode={EVERYTHING:"Everything",POSTCODES:"PostalCodes",COMPANIES:"Companies",PLACES:"Places"},r.templates={AUTOCOMPLETE:"{HighlightedText}{<span class='pcadescription'>{Description}</span>}"},r.example={Id:"GBR|PR|52509479|0|0|0",DomesticId:"52509479",Language:"ENG",LanguageAlternatives:"ENG",Department:"",Company:"Postcode Anywhere",SubBuilding:"Waterside",BuildingNumber:"",BuildingName:"Finger Wharf",SecondaryStreet:"",Street:"Basin Road",Block:"",Neighbourhood:"",District:"",City:"Worcester",Line1:"Waterside",Line2:"Finger Wharf",Line3:"Basin Road",Line4:"",Line5:"",AdminAreaName:"Worcester",AdminAreaCode:"47UE",Province:"Worcestershire",ProvinceName:"Worcestershire",ProvinceCode:"",PostalCode:"WR5 3DA",CountryName:"United Kingdom",CountryIso2:"GB",CountryIso3:"GBR",CountryIsoNumber:826,SortingNumber1:"94142",SortingNumber2:"",Barcode:"(WR53DA1PX)",Label:"Postcode Anywhere\nWaterside\nFinger Wharf\nWorcester\nWR5 3DA\nUnited Kingdom",Type:"Commercial",DataLevel:"Premise",Field1:"",Field2:"",Field3:"",Field4:"",Field5:"",Field6:"",Field7:"",Field8:"",Field9:"",Field10:"",Field11:"",Field12:"",Field13:"",Field14:"",Field15:"",Field16:"",Field17:"",Field18:"",Field19:"",Field20:""},r.fields=t||[],r.options=i||{},r.key=r.options.key||"",r.options.name=r.options.name||"",r.options.source=r.options.source||"",r.options.populate=typeof r.options.populate=="boolean"?r.options.populate:!0,r.options.onlyInputs=typeof r.options.onlyInputs=="boolean"?r.options.onlyInputs:!1,r.options.autoSearch=typeof r.options.autoSearch=="boolean"?r.options.autoSearch:!1,r.options.minSearch=r.options.minSearch||1,r.options.maxItems=r.options.maxItems||0,r.options.advancedFields=r.options.advancedFields||[],r.options.manualEntry=r.options.manualEntry||!1,r.options.disableTime=r.options.disableTime||6e4,r.options.suppressAutocomplete=typeof r.options.suppressAutocomplete=="boolean"?r.options.suppressAutocomplete:!0,r.options.setCountryByIP=typeof r.options.setCountryByIP=="boolean"?r.options.setCountryByIP:!1,r.options.brand=r.options.brand||"PostcodeAnywhere"||"PostcodeAnywhere",r.options.product=r.options.product||"Capture+",r.options.provider=r.options.provider||"CapturePlus"||"CapturePlus",r.options.culture=r.options.culture||"en-GB",r.options.prompt=typeof r.options.prompt=="boolean"?r.options.prompt:!1,r.options.promptDelay=r.options.promptDelay||0,r.options.setCursor=typeof r.options.setCursor=="boolean"?r.options.setCursor:!1,r.options.languagePreference=r.options.languagePreference||"",r.options.countries=r.options.countries||{},r.options.countries.defaultCode=r.options.countries.defaultCode||"",r.options.countries.value=r.options.countries.value||"",r.options.countries.prepopulate=typeof r.options.countries.prepopulate=="boolean"?r.options.countries.prepopulate:!0,r.options.list=r.options.list||{},r.options.list.name=r.options.name?r.options.name+"_results":"",r.options.countries.list=r.options.countries.list||n.merge(r.options.list,{}),r.options.countries.list.name=r.options.name?r.options.name+"_countries":"",r.options.bar=r.options.bar||{},r.options.bar.visible=typeof r.options.bar.visible=="boolean"?r.options.bar.visible:!0,r.options.bar.showCountry=typeof r.options.bar.showCountry=="boolean"?r.options.bar.showCountry:!0,r.options.bar.showLogo=typeof r.options.bar.showLogo=="boolean"?r.options.bar.showLogo:!0,r.options.bar.logoLink=typeof r.options.bar.logoLink=="boolean"?r.options.bar.logoLink:!1,r.options.bar.logoClass=r.options.bar.logoClass||"pcalogo"||"pcalogo",r.options.bar.logoUrl=r.options.bar.logoUrl||"http://www.postcodeanywhere.co.uk/address-capture-software"||"http://www.postcodeanywhere.co.uk/address-capture-software",r.country=r.options.countries.defaultCode,r.advancedFields=r.options.advancedFields,r.initialSearch=!1,r.searchContext=null,r.lastActionTimer=null,r.storedSearch=null,r.geolocation=null,r.loaded=!1,r.language="en",r.autocomplete=null,r.countrylist=null,r.load=function(){for(var p=[],h=[],t,v,f,b,e,w,y,u,a,l,o,s,c=0;c<r.fields.length;c++)t=r.fields[c],t.mode=typeof t.mode=="number"?t.mode:n.fieldMode.DEFAULT,t.mode&n.fieldMode.COUNTRY?(h.push(t.element),/CountryIso2/.test(t.field)&&(r.options.countries.nameType=r.options.countries.nameType||n.countryNameType.ISO2,r.options.countries.valueType=r.options.countries.valueType||n.countryNameType.ISO2),/CountryIso3/.test(t.field)&&(r.options.countries.nameType=r.options.countries.nameType||n.countryNameType.ISO3,r.options.countries.valueType=r.options.countries.valueType||n.countryNameType.ISO3)):t.mode&n.fieldMode.SEARCH&&(p.push(t.element),r.options.suppressAutocomplete&&(v=n.getElement(t.element),v&&(v.autocomplete="off"))),t.field=r.checkFormat(t.field);r.detectLanguage(),r.autocomplete=new n.AutoComplete(p,r.options.list),r.autocomplete.skipFilter=!0,r.autocomplete.listen("keyup",function(n){r.countrylist.autocomplete.visible?r.countrylist.autocomplete.handleKey(n):r.autocomplete.controlDown&&n==40?r.switchToCountrySelect():(n==0||n==8||n>36)&&r.searchFromField()}),r.autocomplete.listen("focus",r.focus),r.autocomplete.listen("blur",r.blur),r.autocomplete.listen("dblclick",r.searchFromField),r.autocomplete.list.listen("filter",function(){r.search(n.getValue(r.autocomplete.field))}),r.autocomplete.listen("delete",r.newSearch),!r.options.countries.value&&h.length&&(r.options.countries.value=n.getValue(h[0])),r.countrylist=new n.CountryList(h,r.options.countries),r.countrylist.autocomplete.options.emptyMessage=r.messages[r.language].NOCOUNTRY,r.country=r.countrylist.country.iso3,r.countrylist.listen("change",function(n){r.country=n&&n.iso3?n.iso3:r.options.countries.defaultCode,r.switchToSearchMode(),r.fire("country",n)}),r.countrylist.autocomplete.listen("filter",function(){r.countrylist.autocomplete.list.first()}),r.countrylist.autocomplete.listen("hide",function(){r.autocomplete.enable(),r.storedSearch!=null&&n.setValue(r.autocomplete.field,r.storedSearch),r.storedSearch=null}),f=n.create("div",{className:"pcaflagbutton"}),b=r.countrylist.flag(),f.appendChild(b),r.autocomplete.footer.setContent(r.options.bar.showCountry?f:""),n.listen(f,"click",r.switchToCountrySelect),e=n.create("div",{className:"pcaflagbutton"}),w=r.countrylist.flag(),e.appendChild(w),r.countrylist.autocomplete.footer.setContent(r.options.bar.showCountry?e:""),n.listen(e,"click",r.switchToSearchMode),y=n.create("div",{className:"pcamessage pcadisableselect",innerHTML:r.messages[r.language].COUNTRYSELECT}),r.autocomplete.footer.setContent(r.options.bar.showCountry?y:""),u=n.create("a",{href:r.options.bar.logoUrl,target:"_blank"}),a=n.create("div",{className:r.options.bar.logoClass+" pcalogo"+r.language}),r.options.bar.logoLink?u.appendChild(a):u=a,r.autocomplete.footer.setContent(u),r.showFooterLogo=function(){u.style.display=r.options.bar.showLogo?"":"none"},r.showFooterMessage=function(){u.style.display=r.options.bar.showCountry?"none":r.options.bar.showLogo?"":"none"},r.options.bar.visible?(r.autocomplete.footer.show(),r.showFooterMessage()):r.autocomplete.hide(),l=n.create("div",{className:"pcamessage pcadisableselect",innerHTML:r.messages[r.language].COUNTRYSELECT}),r.countrylist.autocomplete.footer.setContent(r.options.bar.showCountry?l:""),r.options.bar.visible&&r.countrylist.autocomplete.footer.show(),r.options.setCountryByIP&&r.setCountryByIP(),i.name&&(o=i.list.name,s=i.countries.list.name,n.setAttributes(y,{id:o+"_label"}),n.setAttributes(f,{id:o+"_button",role:"button","aria-labelledby":o+"_label"}),n.setAttributes(l,{id:s+"_label"}),n.setAttributes(e,{id:s+"_button",role:"button","aria-labelledby":s+"_label"})),r.loaded=!0,r.fire("load")},r.searchFromField=function(){var t=n.getValue(r.autocomplete.field);t&&!r.autocomplete.disabled&&!r.initialSearch&&t.length>=r.options.minSearch&&(r.initialSearch=!0,r.search(t))},r.search=function(t){function i(n,t){n.length?r.display(n,r.templates.AUTOCOMPLETE,t):f()}r.searchContext&&(~t.indexOf(r.searchContext.search)?t=t.replace(r.searchContext.search,r.searchContext.text):r.searchContext=null);var u=r.searchContext?r.searchContext.id||"":"";return r.fire("search",t),t&&n.fetch(r.options.provider+"/Interactive/Find/v2.00",{Key:r.key,Country:r.country,SearchTerm:t,LanguagePreference:r.language,LastId:u,SearchFor:r.searchMode.EVERYTHING,$block:!0,$cache:!0},i,r.error),r},r.searchByLocation=function(t,i){function s(n){n&&n.coords?(t=n.coords.latitude,i=n.coords.longitude,o=n.coords.accuracy,r.geolocation=n.coords,e()):u()}function u(){r.message(r.messages[r.language].NOLOCATION,!0)}function e(){function u(n,t){n.length?r.display(n,r.templates.AUTOCOMPLETE,t):f()}n.fetch(r.options.provider+"/Interactive/FindByPosition/v2.00",{Key:r.key,Latitude:t,Longitude:i,LocationAccuracy:o,LanguagePreference:r.language,$block:!0,$cache:!0},u,r.error)}var o=0;return(t||t==0)&&(i||i==0)?e():navigator.geolocation?navigator.geolocation.getCurrentPosition(s,u,{enableHighAccuracy:!0}):u(),r},r.retrieve=function(t){function f(n){n.length?r.populate(n):r.error(r.messages[r.language].RETRIEVEERROR)}for(var u={Key:r.key,Id:t,Source:r.options.source,$cache:!0},i=0;i<r.advancedFields.length;i++)u["field"+(i+1)+"format"]=r.advancedFields[i];n.fetch(r.options.provider+"/Interactive/RetrieveFormatted/v2.00",u,f,r.error)},r.error=function(n){if(r.fire("error",n),!r.listeners.error)throw r.messages[r.language].SERVICEERROR+" "+n;},r.display=function(n,t,i){if(r.autocomplete.header.hide(),r.highlight(n),r.fire("results",n,i),r.autocomplete.clear().add(n,t,r.select).show(),r.autocomplete.list.first(),r.showFooterLogo(),r.options.prompt){function f(){r.message(r.messages[r.language].KEEPTYPING)}u(),r.options.promptDelay?r.lastActionTimer=window.setTimeout(f,r.options.promptDelay):f()}return r.fire("display",n,i),r},r.message=function(n,t){return u(),r.autocomplete.show(),r.autocomplete.header.clear().setText(n).show(),t&&r.autocomplete.clear().list.hide(),r.reposition(),r},r.setCursorText=function(n,t){return r.autocomplete.prompt(n,t),r},r.select=function(t){function i(){var i=n.getValue(r.autocomplete.field);r.options.setCursor?(i=n.removeHtml(t.Text).replace("...",""),r.setCursorText(i,t.Cursor>=0?t.Cursor:null)):(n.setValue(r.autocomplete.field,i+" "),r.autocomplete.field.focus()),r.searchContext={id:t.Id,text:t.Text,search:i},r.search(i)}return r.fire("select",t),t.Next=="Retrieve"?r.retrieve(t.Id):i(),r},r.highlight=function(n,t,i){var e,r,o,f,u;for(t=t||"<b>",i=i||"</b>",e=0;e<n.length;e++){if(r=n[e],r.title=r.Text,r.tag=r.Text,!r.Highlight){r.HighlightedText=r.Text;continue}for(o=r.Highlight.split(","),f=o.length-1;f>=0;f--)u=o[f].split("-"),r.HighlightedText=r.Text.substring(0,parseInt(u[0]))+t+r.Text.substring(parseInt(u[0]),parseInt(u[1]))+i+r.Text.substring(parseInt(u[1]),r.Text.length)}},r.populate=function(t){var f=t[0],s,u,a,h,v,l,o,e,c,i,y;if(r.options.languagePreference)for(s=0;s<t.length;s++)if(t[s].Language==r.options.languagePreference.toUpperCase()){f=t[s];break}for(r.options.countries.prepopulate&&r.countrylist.populate(),u={Line1:null,Line2:null,Line3:null,Line4:null,Line5:null,Street:null,Building:null,Company:null},a=0,h=0;h<r.fields.length;h++)for(v in u)~r.fields[h].field.indexOf(v)&&(u[v]=r.fields[h]);for(l=1;l<=5;l++)for(u["Line"+l]&&a++,o=0;o<r.fields.length;o++)r.fields[o].field=r.fields[o].field.replace(/(Formatted)?Line/g,"FormattedLine");for(u.Building&&u.Street&&a++,e=1;e<=5;e++)f["FormattedLine"+e]=r.getAddressLine(f,e,a,!u.Company);for(r.fire("prepopulate",f),c=0;c<r.fields.length&&r.options.populate;c++)(i=r.fields[c],i.mode&n.fieldMode.POPULATE)&&(!r.options.onlyInputs||n.inputField(i.element)||n.selectList(i.element)||n.checkBox(i.element))&&(i.mode&n.fieldMode.PRESERVE&&n.getValue(i.element)&&r.autocomplete.field!=n.getElement(i.element)||(y=/[\{\}]/.test(i.field)||i.field==""?n.formatLine(f,i.field):f[i.field],n.setValue(i.element,y)));return r.hide(),r.newSearch(),r.fire("populate",f,t),r},r.getAddressLine=function(n,t,i,r){var u,e="",o,s,f;if(r=r&&!!n.Company,r){if(t==1&&i>1)return n.Company;t==1&&i==1?e=n.Company:(t--,i--)}for(u=n.Line1?n.Line2?n.Line3?n.Line4?n.Line5?5:4:3:2:1:0,o=Math.floor(1+(u/i+(i-(t-1))/i)*(t-1)),s=Math.floor(u/i+(i-t)/i),f=0;f<s;f++)e+=(e?", ":"")+(n["Line"+(f+o)]||"");return e},r.switchToCountrySelect=function(){r.countrylist.autocomplete.position(r.autocomplete.field),r.countrylist.autocomplete.field=r.autocomplete.field,r.countrylist.autocomplete.focused=!0,r.countrylist.autocomplete.showAll(),r.countrylist.autocomplete.list.first(),r.autocomplete.disable().hide(),r.storedSearch=n.getValue(r.autocomplete.field),n.clear(r.autocomplete.field),r.autocomplete.field.focus()},r.switchToSearchMode=function(){var n=r.storedSearch!=null;r.autocomplete.enable(),r.countrylist.autocomplete.hide(),n&&(r.newSearch(),r.autocomplete.field.focus(),r.searchFromField())},r.setCountry=function(n){return r.countrylist.setCountry(n),r},r.setCountryByIP=function(){return r.countrylist.setCountryByIP(r.key),r},r.detectLanguage=function(){var n=r.options.culture||(window&&window.navigator?window.navigator.language||window.navigator.browserLanguage:"")||"";r.language=n&&n.length>1?n.substring(0,2).toLowerCase():"en",r.messages[r.language]||(r.language="en")},r.setCulture=function(n){r.options.culture=n,r.reload()},r.setWidth=function(n){r.autocomplete.setWidth(n),r.countrylist.autocomplete.setWidth(n)},r.setHeight=function(n){r.autocomplete.setHeight(n),r.countrylist.autocomplete.setHeight(n)},r.clear=function(){for(var t=0;t<r.fields.length;t++)n.setValue(r.fields[t].element,"");return r.fire("clear"),r},r.reset=function(){return r.options.bar.visible?(r.autocomplete.list.clear().hide(),r.autocomplete.header.hide(),r.showFooterMessage(),r.autocomplete.reposition()):(r.autocomplete.hide(),r.autocomplete.footer.hide()),u(),r.newSearch(),r},r.newSearch=function(){r.initialSearch=!1},r.focus=function(){r.reset(),r.options.autoSearch&&r.searchFromField(),r.fire("focus")},r.blur=function(){u(),r.countrylist.autocomplete.field=null,r.countrylist.autocomplete.focused=!1,r.countrylist.autocomplete.checkHide(),r.fire("blur")},r.hide=function(){u(),r.autocomplete.hide(),r.countrylist.autocomplete.hide(),r.fire("hide")},r.visible=function(){return r.autocomplete.visible||r.countrylist.autocomplete.visible},r.reposition=function(){r.autocomplete.reposition(),r.countrylist.autocomplete.reposition()},r.disable=function(){return r.autocomplete.disabled=!0,r.countrylist.autocomplete.disabled=!0,r},r.enable=function(){return r.autocomplete.disabled=!1,r.countrylist.autocomplete.disabled=!1,r},r.destroy=function(){return r.autocomplete.destroy(),r.countrylist.autocomplete.destroy(),r},r.reload=function(){r.destroy(),r.load()},r.manualEntry=function(){return window&&window.setTimeout&&r.options.disableTime&&(r.autocomplete.field.focus(),r.destroy(),window.setTimeout(r.load,r.options.disableTime),r.fire("manual")),r},r.bound=function(i){if(i=n.getElement(i))for(var u=0;u<r.fields.length;u++)if(i==n.getElement(t[u].element))return!0;return!1},r.checkFormat=function(n){function t(n){for(var t in r.example)if(t==n)return!0;return!1}return n.replace(/\{(\w+)\}/g,function(n,i){return t(i)?n:(r.advancedFields.push(n),"{Field"+r.advancedFields.length+"}")})},n.ready(r.load)}})()